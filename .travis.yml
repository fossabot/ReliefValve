# Set language as Node.js, and use
#   the latest stable release of v7.
language: node_js
node_js: "7"


# Run on Linux, Ubuntu 14.04.X LTS
#   aka "Trusty Tahr".
os: linux
dist: trusty


# Cache directories for faster builds.
# Need to add more to this..
cache:
  directories:
  - node_modules
  - app/node_modules


# Update the global npm install and
#   then install the dependencies
#   for ./app.
install:
- npm i npm -g
- npm i


# Use npm run to execute
#   electron-builder to build the
#   project for both 32 & 64-bit
#   platforms of Linux or Windows.
script:
- npm run dist-32_64


# Create a global variable for each
#   of the 32 & 64-bit release packages
#   and echo their paths.
before_deploy:
- export RELEASE_32=$(ls $TRAVIS_BUILD_DIR/dist/*ia32.AppImage)
- export RELEASE_64=$(ls $TRAVIS_BUILD_DIR/dist/*x86_64.AppImage)
- echo "Deploying $RELEASE_32 & $RELEASE_64 to GitHub releases."


# Handle deploying the app to GitHub
#   via GitHub "Releases".
deploy:
  provider: releases
  # Needed to access GitHub API.
  #   Unique to me; get your own!
  api_key:
    secure: gqm08fGxN8qhKtmuo6hvEq/dsif6YqIXr5PiIAT2yAdbtmJh5N7+B38uEzZUNMtKqFpZYMGwn07lAEdYwx0cnEAFE+4NcfscJK5uSkrp2VX0yGJnDazMi1ru+wfBinxQ5yxC4mQdC5WVJPcF4OizhYhG4VEcjff4zVDFWA6f0kqEfMCEHDbp8I+h9plmc7amoNZBA39+1UYwlXjL8sQRpPEk84XMSZAJC1LV7k04WJMuAXLYAxSnkCdMZyNpdKp8oEQwtk3Zyn2tTlhNgerVm2tVV+r/J/HCysDXQaD5HLAeIrIS+s95EorWnKOd8ysc/gSnGmOUO2bE9qPCctlJ1Do4QWZelfzOeRAaNpBF+qxnMoE+mZ0LyuFtri07tlFpIR1+2W5d1RY3eWOjnOILsG27lfBkpHldy64LATP4aAw0Up3PyB+LmykTMr7Pqynf4AMPRecwJeRGbM/FSi/pN+S0Lm+1TnM8BVDu5WbVMtxfhZRWGNfdrZ8/wJdKCf/kU6U36JWcmReVAkc96RavqA3ftQqmYxd8gdAWCYw6Vk86VVy+kk7wTyK1PwtP0qGLGeBk4I65i6GYos3GtAf8+v5MHljTsG0fpAHqdafxcBRZsuTq/FDbLqu6z5TMAMM5hMKYIx9OUmWsoPaWdyLOOAybU/noesylaCVwom4Czm4=
  # Needed to upload multiple artifacts
  #   (files), AFAIK.
  file_glob: true
  file:
    - "$RELEASE_32"
    - "$RELEASE_64"
  # Don't let the system clean up, it
  #   will delete the built files and
  #   then the deploy will fail as
  #   there will be no artifacts.
  skip_cleanup: true
  on:
    # Only deploy from the given repo.
    repo: l3laze/ReliefValve
    # Deploy from any branch? True/False.
    all_branches: false
    # Deploy on tags? True/False.
    tags: true

# Setup build notifications
notifications:
  # I was being harassed while setting
  #   this all up..lol.
  email: false
